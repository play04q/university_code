%% 民机参数计算
clear;clc;clf;close all;
%高度与密度表达式 密度=-3.141e-14*x^3+3.245e-9*x^2-0.0001091*x+1.211

%% 
% exp((-1000*9.8*1.41e-5*7000)/(0.8*340*7.15))
% 1.06*(1-0.98*0.9805*0.6081*0.97*0.8831*0.9945)
m=540000:1000:550000;
ym=(1-0.5324)*m-0.97*(m.^0.94)-158*100;
plot(m,ym);

%% 飞行包线
C1=0.8;C3=1.2;F=70e4;S=324;m=57e3;g=9.8;
h001=0:100:25000;
Pro=-3.141e-14*h001.^3+3.245e-9*h001.^2-0.0001091*h001+1.211;
Vmax=2/3.*(2*F./(C1*exp(Pro-3.8)*S)).^(1/2); %原公式(2*F./(C1*Pro*S)).^(1/2)
Vmin=2/3.*(2*m*g./(C3*Pro*S)).^(1/2); %原公式(2*m*g./(C3*Pro*S)).^(1/2)
plot(Vmax,h001);
hold on;
plot(Vmin,h001);
xlabel('速度 m/s');ylabel('高度 m');title('飞行包线')

%%  给定高度的爬升率
alf=6*pi/180;C2=0.4;F=70e4;
h001=0:100:30000;
Pro=-3.141e-14*h001.^3+3.245e-9*h001.^2-0.0001091*h001+1.211;
Vmax=(2*F./(C1*Pro*S)).^(1/2);
Vmin=(2*m*g./(C3*Pro*S)).^(1/2);
V=(Vmax+Vmin)/2; % xxxm下速度
D=0.5.*Pro.*V.^2.*S.*C2;
Vz=1000./(((F.*cos(alf)-D).*V)/(m*g))-2.5; %原公式((F.*cos(alf)-D).*V)/(m*g)
plot(Vz,h001);
xlabel('爬升率 m/s');ylabel('高度 m');title('爬升率随高度的变化曲线')

%%   升阻比
sita=0:1:90;
cl=[0.45 0.53 0.60 0.69 0.78 0.83 0.91 1.01 1.11 1.15 1.23 1.32 1.38 1.48 1.57 1.65 1.70 1.75 1.81 1.89 1.99 2.05 2.15 2.23 2.30 2.33 2.39 2.50 2.60 2.67 2.70 2.72 2.79 2.81 2.91 3.00 3.07 3.10 3.11 3.19 3.28 3.32 3.40 3.50 3.60 3.62 3.70 3.85 3.74 3.82 3.89 3.92 4.05 4.12 4.20 4.22 4.29 4.32 4.37 4.39 4.40 4.52 4.61 4.70 4.75 4.80 4.82 4.90 4.93 4.90 4.89 4.90 4.90 4.90 4.89 4.88 4.87 4.85 4.82 4.79 4.75 4.69 4.65 4.60 4.55 4.53 4.48 4.46 4.45 4.40 4.40];
cl1=cl./1.8;
plot(sita,cl1);
xlabel('Alpha');ylabel('CL');title('"翔宇—100"升力系数曲线');
% CDo=[0.015 0.0152 0.016 0.017 0.018 0.019 0.0197 0.02 0.023 0.023 0.0225 0.0243 0.025 0.0265 0.027 0.029 0.030 0.031 0.032 0.033 0.035 0.0360 0.038 0.040 0.0412 0.0425 0.0430 0.044 0.0453 0.0478 0.0489 0.050 0.052 0.053 0.054 0.055 0.0562 0.057 0.0592 0.060 0.062 0.0632 0.0641 0.0650 0.0660 0.0665 0.0680 0.0689 0.0693 0.0690 0.0705 0.0712 0.072 0.073 0.0741 0.0742 0.0738 0.0735 0.0733 0.0729 0.0732 0.0742 0.0739 0.0728 0.0716 0.0712 0.070 0.0692 0.0660 0.065 0.0639 0.0597 0.0563 0.0537 0.050 0.0479 0.045 0.0425 0.0397 0.035 0.0307 0.0239 0.020 0.0175 0.013 0.0097 0.005 0.0021 -0.0029 -0.0065 -0.014]
% plot(sita,CDo)
% cl1=[0.45 0.53 0.60 0.69 0.78 0.83 0.91 1.01 1.11 1.15 1.23 1.32 1.38 1.48 1.57 1.65 1.70 1.75 1.81 1.89 1.99 2.05 2.15 2.23 2.30 2.33 2.39 2.50 2.60 2.67 2.70 2.72 2.79 2.81 2.91 3.00 3.07 3.10 3.11 3.19 3.28 3.32 3.40 3.50 3.60 3.62 3.70 3.85 3.74 3.82 3.89 3.92 4.05 4.12 4.20 4.22 4.29 4.32 4.37 4.39 4.40 4.52 4.61 4.70 4.75 4.80 4.82 4.90 4.93 4.90 4.89 4.90 4.90 4.90 4.89 4.88 4.87 4.85 4.82 4.79 4.75 4.69 4.65 4.60 4.55 4.53 4.48 4.46 4.45 4.40 4.40]
% plot(sita,cl1)
% xlabel('Alpha')
% CDo1=[0.015 0.0152 0.016 0.017 0.018 0.019 0.0197 0.02 0.023 0.023 0.0225 0.0243 0.025 0.0265 0.027 0.029 0.030 0.031 0.032 0.033 0.035 0.0360 0.038 0.040 0.0412 0.0425 0.0430 0.044 0.0453 0.0478 0.0489 0.050 0.052 0.053 0.054 0.055 0.0562 0.057 0.0592 0.060 0.062 0.0632 0.0641 0.0650 0.0660 0.0665 0.0680 0.0689 0.0693 0.0690 0.0705 0.0712 0.072 0.073 0.0741 0.0742 0.0738 0.0735 0.0733 0.0729 0.0732 0.0742 0.0739 0.07
% ld=cl./CDo;
% plot(sita,ld)
% cl22=[0.35 0.78 1.09 1.13 1.06 0.98 1.10];
% a=[0 5 10 15 20 25 30];
a=0:1:30;
cl22=5.818e-6.*a.^4-0.0002202.*a.^3-0.001109.*a.^2+0.09952.*a+0.347;
plot(a,cl22)
xlabel('Alpha');ylabel('CL');title('同类型飞机升力系数曲线');